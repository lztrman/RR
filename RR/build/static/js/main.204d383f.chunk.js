(this.webpackJsonpRR=this.webpackJsonpRR||[]).push([[0],{32:function(e,o,t){e.exports=t(69)},37:function(e,o,t){},66:function(e,o){},69:function(e,o,t){"use strict";t.r(o);var n=t(0),c=t.n(n),r=t(31),a=t.n(r),i=(t(37),t(6)),s=t(7),l=t(9),d=t(10),m=t(8),u=t.n(m),f=function(e){Object(d.a)(t,e);var o=Object(l.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=o.call(this,e)).componentDidMount=function(){console.log("this room room id is "+n.roomId),console.log("this room type is "+n.type),n.socket=u()("/room",{path:"/webrtc",query:{}}),n.socket.on("connection-success",(function(e){if("create"===n.type){var o={room:n.roomId};n.sendToServer("createRoom",o)}else if("join"===n.type){var t={room:n.roomId};n.sendToServer("joinRoom",t)}console.log("connection success")})),n.socket.on("offerOrAnswer",(function(e){console.log("Setting remote description by "+n.socket.id),n.pc.setRemoteDescription(new RTCSessionDescription(e))})),n.socket.on("candidate",(function(e){console.log("Adding ice candidate by "+n.socket.id+"and the candidate is "+e),n.pc.addIceCandidate(new RTCIceCandidate(e))}));n.pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),n.pc.onicecandidate=function(e){e.candidate&&(console.log("Sending candidate from "+n.socket.id+" to server "),n.sendToServer("candidate",e.candidate))},n.pc.oniceconnectionstatechange=function(e){console.log(e)},n.pc.onaddstream=function(e){n.remoteVideoref.current.srcObject=e.stream};navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(e){console.log("Get user media success by "+n.socket.id),window.localStream=e,n.localVideoref.current.srcObject=e,n.pc.addStream(e)})).catch((function(e){console.log("getUserMedia Error: ",e)}))},n.sendToServer=function(e,o){n.socket.emit(e,{socketID:n.socket.id,payload:o})},n.createOffer=function(){console.log("Offer"),n.pc.createOffer({offerToReceiveVideo:1}).then((function(e){n.pc.setLocalDescription(e),n.sendToServer("offerOrAnswer",e),console.log("Sending offer to server by "+n.socket.id)}))},n.createAnswer=function(){n.pc.createAnswer({offerToReceiveVideo:1}).then((function(e){n.pc.setLocalDescription(e),n.sendToServer("offerOrAnswer",e),console.log("Sending answer to server by "+n.socket.id)}))},n.localVideoref=c.a.createRef(),n.remoteVideoref=c.a.createRef(),n.roomId=n.props.roomId,n.type=n.props.type,n.socket=null,n.candidates=[],n}return Object(s.a)(t,[{key:"render",value:function(){return c.a.createElement("div",null,c.a.createElement("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},ref:this.localVideoref,autoPlay:!0}),c.a.createElement("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},ref:this.remoteVideoref,autoPlay:!0}),c.a.createElement("br",null),c.a.createElement("button",{onClick:this.createOffer},"Offer"),c.a.createElement("button",{onClick:this.createAnswer},"Answer"))}}]),t}(n.Component),p=function(e){Object(d.a)(t,e);var o=Object(l.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=o.call(this,e)).componentDidMount=function(){n.socket=u()("/admin",{path:"/webrtc",query:{}}),n.socket.on("connection-success",(function(e){console.log("connection success")})),n.socket.on("createAccept",(function(e){console.log(e.message),n.roomId=document.getElementById("roomTf").value,console.log("this app room id is "+n.roomId),n.type="create",console.log("this app type is "+n.type),n.setState({inRoom:!0})})),n.socket.on("createReject",(function(e){alert(e.message),console.log(e.message)}))},n.sendToServer=function(e,o){n.socket.emit(e,{socketID:n.socket.id,payload:o})},n.createRoom=function(){console.log("create room function called. ");var e={room:document.getElementById("roomTf").value};n.sendToServer("checkCreate",e)},n.joinRoom=function(){console.log("join room function called. "),n.roomId=document.getElementById("roomTf").value,console.log("this app room id is "+n.roomId),n.type="join",console.log("this app type is "+n.type),n.setState({inRoom:!0})},n.state={inRoom:!1},n.roomId=null,n.type=null,n.roomRef=c.a.createRef(),n.nameRef=c.a.createRef(),n}return Object(s.a)(t,[{key:"render",value:function(){switch(this.state.inRoom){case!0:return c.a.createElement("div",null,c.a.createElement(f,{type:this.type,roomId:this.roomId}));case!1:return c.a.createElement("div",null,c.a.createElement("h1",null,"Welcome to Red Rhinoceros! "),c.a.createElement("p",null," please enter room number "),c.a.createElement("input",{type:"text",ref:this.roomRef,id:"roomTf"}),c.a.createElement("p",null," please enter your name "),c.a.createElement("input",{type:"text",ref:this.nameRef,id:"nameTf"}),c.a.createElement("button",{onClick:this.createRoom,id:"ceateBtn"},"CREATE ROOM"),c.a.createElement("button",{onClick:this.joinRoom,id:"joinBtn"},"JOIN ROOM"));default:return c.a.createElement("div",{id:"error"},c.a.createElement("h1",null," this really should not happen "))}}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(p,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[32,1,2]]]);
//# sourceMappingURL=main.204d383f.chunk.js.map