(this.webpackJsonpRR=this.webpackJsonpRR||[]).push([[0],{105:function(e,o){},108:function(e,o,t){},155:function(e,o,t){"use strict";t.r(o);var n=t(0),r=t.n(n),c=t(6),a=t.n(c),i=(t(76),t(18)),s=t(19),l=t(23),d=t(24),m=t(20),u=t.n(m),p=function(e){Object(d.a)(t,e);var o=Object(l.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=o.call(this,e)).componentDidMount=function(){console.log("this room room id is "+n.roomId),console.log("this room type is "+n.type),n.socket=u()("/admin",{path:"/webrtc",query:{}}),n.socket.on("connection-success",(function(e){if("create"===n.type){var o={room:n.roomId};n.sendToServer("createRoom",o)}else if("join"===n.type){var t={room:n.roomId};n.sendToServer("joinRoom",t)}console.log("connection success")})),n.socket.on("offerOrAnswer",(function(e){console.log("Setting remote description by "+n.socket.id),n.pc.setRemoteDescription(new RTCSessionDescription(e))})),n.socket.on("candidate",(function(e){console.log("Adding ice candidate by "+n.socket.id+"and the candidate is "+e),n.pc.addIceCandidate(new RTCIceCandidate(e))}));n.pc=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),n.pc.onicecandidate=function(e){e.candidate&&(console.log("Sending candidate from "+n.socket.id+" to server "),n.sendToServer("candidate",e.candidate))},n.pc.oniceconnectionstatechange=function(e){console.log(e)},n.pc.onaddstream=function(e){n.remoteVideoref.current.srcObject=e.stream};navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(e){console.log("Get user media success by "+n.socket.id),window.localStream=e,n.localVideoref.current.srcObject=e,n.pc.addStream(e)})).catch((function(e){console.log("getUserMedia Error: ",e)}))},n.sendToServer=function(e,o){n.socket.emit(e,{socketID:n.socket.id,payload:o})},n.createOffer=function(){console.log("Offer"),n.pc.createOffer({offerToReceiveVideo:1}).then((function(e){n.pc.setLocalDescription(e),n.sendToServer("offerOrAnswer",e),console.log("Sending offer to server by "+n.socket.id)}))},n.createAnswer=function(){n.pc.createAnswer({offerToReceiveVideo:1}).then((function(e){n.pc.setLocalDescription(e),n.sendToServer("offerOrAnswer",e),console.log("Sending answer to server by "+n.socket.id)}))},n.localVideoref=r.a.createRef(),n.remoteVideoref=r.a.createRef(),n.roomId=n.props.roomId,n.type=n.props.type,n.socket=null,n.candidates=[],n}return Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,this.roomId),r.a.createElement("br",null),r.a.createElement("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},ref:this.localVideoref,autoPlay:!0}),r.a.createElement("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},ref:this.remoteVideoref,autoPlay:!0}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.createOffer},"Offer"),r.a.createElement("button",{onClick:this.createAnswer},"Answer"))}}]),t}(n.Component),f=t(158),h=t(39),g=(t(108),function(e){Object(d.a)(t,e);var o=Object(l.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=o.call(this,e)).componentDidMount=function(){n.socket=u()("/admin",{path:"/webrtc",query:{}})},n.createRoom=function(){console.log("create room function called. "),n.roomId=document.getElementById("roomTf").value,console.log("this app room id is "+n.roomId),n.type="create",console.log("this app type is "+n.type),n.setState({inRoom:!0})},n.joinRoom=function(){console.log("join room function called. "),n.roomId=document.getElementById("roomTf").value,console.log("this app room id is "+n.roomId),n.type="join",console.log("this app type is "+n.type),n.setState({inRoom:!0})},n.state={inRoom:!1},n.roomId=null,n.type=null,n.roomRef=r.a.createRef(),n.nameRef=r.a.createRef(),n}return Object(s.a)(t,[{key:"render",value:function(){switch(this.state.inRoom){case!0:return r.a.createElement("div",null,r.a.createElement(p,{type:this.type,roomId:this.roomId}));case!1:return r.a.createElement("div",null,r.a.createElement("h1",{class:"App"},"Welcome to Red Rhinoceros! "),r.a.createElement("p",{class:"App"}," please enter room number "),r.a.createElement(f.a,{class:"App",type:"text",ref:this.roomRef,size:"large",value:"Room Number"}),r.a.createElement("p",{class:"App"}," please enter your name "),r.a.createElement(f.a,{class:"App",type:"text",ref:this.nameRef,size:"large",value:"Your Name"}),r.a.createElement("br",null),r.a.createElement(h.a,{type:"primary",onClick:this.createRoom,id:"ceateBtn"},"CREATE ROOM"),r.a.createElement("br",null),r.a.createElement(h.a,{type:"primary",onClick:this.joinRoom,id:"joinBtn"},"JOIN ROOM"));default:return r.a.createElement("div",{id:"error"},r.a.createElement("h1",null," this really should not happen "))}}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},71:function(e,o,t){e.exports=t(155)},76:function(e,o,t){}},[[71,1,2]]]);
//# sourceMappingURL=main.5f0ca7e4.chunk.js.map